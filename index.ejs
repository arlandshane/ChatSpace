<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Chat Space</title>
		<link rel="stylesheet" href="/css/style.css" />
		<link
			rel="shortcut icon"
			href="/icons/favicon.png"
			type="image/x-icon"
		/>
	</head>

	<body>
		<nav style="padding: 0 1rem">
			<h1>Chat Space</h1>
			<div>
				<% if (currentUser) { %>
				<a
					style="
						display: inline-flex;
						text-decoration: none;
						color: black;
						gap: 0.5rem;
					"
					href="/user/<%= currentUser.username %>"
				>
					<p><%= currentUser.username %></p>
					<img
						class="avatar"
						src="<%= currentUser.profilePicUrl %>"
						alt="dp"
					/>
				</a>
				<% } %>
			</div>
		</nav>
		<hr />
		<!-- <div
			style="
				display: flex;
				flex-wrap: nowrap;
				overflow-x: auto;
			"
		>
			<% users.forEach(user => { %> <% if(currentUser.username !==
			user.username) { %>
			<button
				type="button"
				class="btn"
				style="width: fit-content; border-radius: 0.5rem"
			>
				<a href="/privateChat/<%= currentUser._id %>/<%= user._id %>">
					<%= user.username %>
				</a>
			</button>
			<% } }) %>
		</div> -->
		<div style="display: flex; flex-wrap: nowrap; overflow-x: auto">
			<a href="/privateChat">
				<button class="btn" style="border-radius: 0.5rem">
					People
				</button>
			</a>
			<a href="/spaces">
				<button class="btn" style="border-radius: 0.5rem">
					Spaces
				</button>
			</a>
			<a href="/spacify">
				<button class="btn" style="border-radius: 0.5rem">
					Spacify
				</button>
			</a>
			<a href="/spacetube">
				<button class="btn" style="border-radius: 0.5rem">
					SpaceTube
				</button>
			</a>
			<button id="chat" class="btn" style="border-radius: 0.5rem">
				Post
			</button>
		</div>
		<div style="display: flex">
			<div>
				<form style="display: none" id="form" action="/" method="post">
					<textarea
						style="width: 40rem; min-height: 5rem"
						maxlength="200"
						type="text"
						name="message"
						id="message"
						placeholder="*Character limit: 200"
						required
					></textarea>
					<button
						id="add-btn"
						style="align-self: flex-end"
						class="btn"
						type="submit"
					>
						Send
					</button>
				</form>
				<div id="blur" style="overflow: auto; height: 80vh">
					<h2 style="margin-left: 1rem">Posts:</h2>
					<% persons.slice().reverse().forEach((person) => { %>
					<div style="display: flex; margin-left: 0.5rem">
						<p class="each-message">
							<%= person.name %>
							<span
								style="
									opacity: 0.8;
									font-weight: lighter;
									white-space: pre-line;
								"
							>
								~&nbsp;<%= person.message %>
							</span>
						</p>
					</div>
					<% }); %>
				</div>
			</div>
			<div id="your-spaces">
				<h4>Your Spaces:</h4>
				<% if(spaces.length === 0) { %>
				<p>None</p>
				<% } %> <% spaces.forEach((space) => { %>
				<a
					href="/spaces/<%= space._id %>"
					style="
						border-radius: 1rem;
						padding: 1rem;
						white-space: nowrap;
						border: 1px solid rgba(100, 150, 200, 0.5);
					"
				>
					<%= space.name %>
				</a>
				<% }) %>
				<a href="/createSpace">
					<button style="white-space: nowrap" class="btn">
						Create Space
					</button>
				</a>
			</div>
		</div>
		<!-- 
		<hr />
		<footer>
			<div
				style="display: flex; justify-content: flex-end; margin: 1rem 0"
			>
				<a
					style="
						text-decoration: none;
						color: black;
						font-family: 'Segoe UI', Tahoma, Geneva, Verdana,
							sans-serif;
						align-self: center;
					"
					href="https://arlandshane.com"
					target="_blank"
				>
					©️ 2023 Shane Arland
				</a>
				<a href="/terms-of-service">
					<button style="width: fit-content" class="btn">
						Terms of Service
					</button>
				</a>

				<a href="/privacy-policy">
					<button style="width: fit-content" class="btn">
						Privacy Policy
					</button>
				</a>
			</div>
		</footer>
		-->
		<script defer>
			const form = document.getElementById("form");
			const chat = document.getElementById("chat");
			const blur = document.getElementById("blur");
			chat.addEventListener("click", () => {
				if (form.style.display === "none") {
					blur.style.filter = "blur(5px)";
					chat.style.backgroundColor = "#222831";
					chat.style.color = "#EEEEEE";
					form.style.display = "flex";
				} else {
					blur.style.filter = "none";
					chat.style.backgroundColor = "white";
					chat.style.color = "black";
					form.style.display = "none";
				}
			});
		</script>
	</body>
</html>
